#!/usr/bin/env bash

set -eux

ninja


ARR=(
    # "adload-1"
    # "adload-64"
    # "adload-256"
    # "adload-1024"
    # "bitcoinminer-1"
    # "bitcoinminer-64"
    # "bitcoinminer-256"
    # "bitcoinminer-1024"
    # "dridex-1"
    # "dridex-64"
    # "dridex-256"
    # "dridex-1024"
    # "feiwo-1"
    # "feiwo-64"
    # "feiwo-256"
    # "feiwo-1024"
    # "penetho-1"
    # "penetho-64"
    # "penetho-256"
    # "penetho-1024"
    # "plankton-1"
    # "plankton-64"
    # "plankton-256"
    # "plankton-1024"
    # "sality-1"
    # "sality-64"
    # "sality-256"
    # "sality-1024"
    # "snojan-1"
    # "snojan-64"
    # "snojan-256"
    # "snojan-1024"
    # "thbot-1"
    # "thbot-64"
    # "thbot-256"
    # "thbot-1024"
    # "trojanminer-1"
    # "trojanminer-64"
    # "trojanminer-256"
    # "trojanminer-1024"
    # "webcompanion-1"
    # "webcompanion-64"
    # "webcompanion-256"
    # "webcompanion-1024"
    # "zsone-1"
    # "zsone-64"
    # "zsone-256"
    # "zsone-1024"
)

for item in ${ARR[@]}; do
    for (( counter=1; counter<="@1"; counter++ )) do
        ./HyperVision -config ../configuration/malware/${item}.json > ../cache/${item}.log # &
        mv  ../cache/${item}.log ../cache/malware/${item}-$counter.log
        mv  ../temp/${item}.txt ../temp/malware/${item}-$counter.txt
    done
    cd ../result_analyze
    python3 batch_analyzer-single.py -g ${item}-mass
    cd ../build
    rm  ../temp/malware/${item}*.txt
done
